source("~/Desktop/Chan-Ynu/FoF/Code/003-Code-fof-2025_12_24/North_Dakota/Gdat_North.R")
setwd("~/Desktop/Chan-Ynu/FoF/Code/003-Code-fof-2025_12_24/North_Dakota/")
dat = read.csv("North_Dakota.csv")
dat
y = dat$Y
y
source("~/Desktop/Chan-Ynu/FoF/Code/003-Code-fof-2025_12_24/North_Dakota/Gdat_North.R")
matrix(dat$Y, ncol = 100, byrow = T)
dat$Y
weather = read.csv("North_Dakota.csv", header = T)
STA = unique(weather[,1])
STA
STA_ara = STA[which(as.numeric(table(weather[,1])) == 100)]
STA_ara
weather = weather[weather[,1] %in% STA_ara, ]
weather = weather[,-1]
#transfer the unit
Temper = matrix((weather[, 1] - 32) * 5 / 9, ncol = 100, byrow = T)
Windspeed = matrix(weather[, 2] * 0.44704, ncol = 100, byrow = T)
TSR = matrix(weather[, 3] / 100, ncol = 100, byrow = T) #total solar radiation
Temper
Windspeed = matrix(weather[, 2] * 0.44704, ncol = 100, byrow = T)
TSR = matrix(weather[, 3] / 100, ncol = 100, byrow = T) #total solar radiation
TSR
source("~/Desktop/Chan-Ynu/FoF/Code/003-Code-fof-2025_12_24/North_Dakota/Gdat_North.R")
library(JM2surv)
demo_path <- system.file("examples", "demo.R", package = "JM2surv")
demo_path
source(demo_path)
demo_path <- system.file("examples", "demo.R", package = "JM2surv")
demo_path
source(demo_path)
source("~/Desktop/Chan-Ynu/Sci投稿与返修/CSDA/001_Data_CSDA_R2_2026-02-07/JM2surv/inst/examples/demo.R")
library(usethis)
usethis::create_package("~/Desktop/JM2surv_Clayton")
library(usethis)
usethis::create_package("~/Desktop/JM2survClayton")
unlink(list.files("src", pattern = "\\.(o|so)$", full.names = TRUE))
library(JM2survClayton)
?JM2survClayton::mjoint_Clayton
source("~/Desktop/JM2survClayton/R/mjoint_Clayton.R")
source("~/Desktop/JM2survClayton/R/mjoint_Clayton.R")
setwd("~/Desktop/JM2survClayton")  # 改成你包的真实路径
getwd()
list.files()
devtools::load_all()
roxygen2::roxygenise()
library(JM2survClayton)
?JM2survClayton::mjoint_Clayton
JM2survClayton::blocks
data("Gaussian_Clayton_One")
a1 = data("Gaussian_Clayton_One")
a1
blocks <- load_blocks("Poisson_Clayton_Two.rda")
## 0) helper to load local rda (outside package) or use `data()` if you store in /data
load_blocks <- function(rda_file) {
e <- new.env(parent = emptyenv())
load(rda_file, envir = e)
if (!exists("blocks", envir = e)) stop("The .rda file must contain object 'blocks'.")
blocks <- get("blocks", envir = e)
if (!is.list(blocks) || !all(c("Longdat","Surdat1","Surdat2") %in% names(blocks))) {
stop("blocks must be a list with: Longdat, Surdat1, Surdat2.")
}
blocks
}
## 1) timevars builder: fixed uses (B1,B2,B3) in Surdat; rand depends on random-effect dimension
make_timevars <- function(re_dim = 1) {
stopifnot(re_dim %in% c(1, 2))
fixed_fun <- function(t, index, Sur = NULL, ...) {
if (is.null(Sur)) stop("fixed_fun: Sur is NULL (build_surv_block must pass Sur=).")
B1 <- Sur$B1[index]; B2 <- Sur$B2[index]; B3 <- Sur$B3[index]
z  <- B1 * (t <= B3) + B2 * (t > B3)
matrix(z, ncol = 1)
}
rand_fun <- function(t, index, ...) {
if (re_dim == 1) matrix(1, nrow = length(t), ncol = 1) else cbind(1, t)
}
list(fixed = fixed_fun, rand = rand_fun)
}
## 2) choose one dataset you created (local path example)
blocks <- load_blocks("Poisson_Clayton_Two.rda")
load("Gaussian_Clayton_One.rda")
